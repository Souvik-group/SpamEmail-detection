import pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score, classification_report\nimport pickle\n\n# Load your dataset (replace with your actual data loading)\n# df = pd.read_csv('your_spam_dataset.csv')\n\n# For demo purposes, creating sample data\n# Replace this with your actual dataset\nsample_data = {\n    'message': [\n        'Free money! Click here now!',\n        'Hello, how are you today?',\n        'URGENT: You have won $1000000!',\n        'Meeting scheduled for tomorrow at 3pm',\n        'Limited time offer! Buy now!',\n        'Thanks for your help yesterday'\n    ],\n    'label': [1, 0, 1, 0, 1, 0]  # 1 = spam, 0 = not spam\n}\n\ndf = pd.DataFrame(sample_data)\n\n# Prepare data\nX = df['message']\ny = df['label']\n\n# Split data\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42, stratify=y\n)\n\n# Create and fit vectorizer\nvectorizer = TfidfVectorizer(\n    stop_words='english',\n    max_df=0.95,\n    min_df=1,  # Changed from 2 to 1 for small dataset\n    lowercase=True\n)\n\nX_train_vec = vectorizer.fit_transform(X_train)\nX_test_vec = vectorizer.transform(X_test)\n\n# Train model\nmodel = MultinomialNB()\nmodel.fit(X_train_vec, y_train)\n\n# Test model\ny_pred = model.predict(X_test_vec)\nprint(f\"Accuracy: {accuracy_score(y_test, y_pred)}\")\n\n# Save model and vectorizer\nwith open('model.pkl', 'wb') as f:\n    pickle.dump(model, f)\n\nwith open('vectorizer.pkl', 'wb') as f:\n    pickle.dump(vectorizer, f)\n\nprint(\"Model and vectorizer saved successfully!\")\nprint(\"Now you can run the Flask app with: python app.py\")